# 时序

- 上升沿1：

  - 从指令cache中取出指令根据指令选取：
    - ALU操作
    - 输入数据1
    - 输入数据2
    - 输出数据
  
    具体选取方案如下
  
    | 指令              | ALU      | 输入1连接 | 输入2连接 | 输出连接 |
    | ----------------- | -------- | --------- | --------- | -------- |
    | LUI               | 有符号加 | imm       | 0         | 寄存器   |
    | AUIPC             | 有符号加 | imm       | PC        | 寄存器   |
    | JAL               | 有符号加 | 4         | PC        | 寄存器   |
    | JALR              | 有符号加 | 4         | PC        | 寄存器   |
    | 条件跳转          | 有符号加 | 0         | 0         | x0       |
    | LOAD              | 有符号加 | 0         | 内存      | 寄存器   |
    | STORE             | 有符号加 | 0         | 寄存器    | 内存     |
    | 寄存器-立即数运算 | 运算     | imm       | 寄存器    | 寄存器   |
    | 寄存器-寄存器运算 | 运算     | 寄存器    | 寄存器    | 寄存器   |
  
    另外，有些指令虽然并不涉及寄存器的运算但仍然需要取出寄存器的值：
  
    - JALR，需要多取出一个寄存器，与指令中的imm相加得到地址
    - 条件跳转需要取出两个寄存器，以进行比较
    - LOAD/STORE需要多取出一个寄存器，与指令中的imm相加得到地址
  
- 下降沿1：

  所有使能的存储模块存下当前输入线上的值。

  根据指令计算下一个PC：

  - 无条件跳转，直接设置为指令要求跳转到的地址
  - 有条件跳转，条件符合则跳转到要求的地址
  - 其他情况，PC=PC+4

